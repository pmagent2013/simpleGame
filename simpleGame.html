<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
      <title>Simple Game</title>
      <script>
         // Global Variables
		var points = 0;
		//var gun;
		var x=2;
		var y=2;
		var map=[[-1,-1,-1,-1,-1],
                 [-1, 0, 1, 2,-1],
                 [-1, 3, 4, 5,-1],
                 [-1, 6, 7, 8,-1],
                 [-1,-1,-1,-1,-1]];
        var locID = "";
		var name = "";
		var description = "";
		var item = "";
		var points;
		var itemID = "";
		var itemName = "";
		var itemDescription = "";
		var itemCount = "";
		var locale = function(id, name, description, item, points){
			this.id = id;
			this.name = name;
			this.description = description;
			this.item = item;
			this.points = points;
		}
		var locales = [];
		locales.push(new locale('enemyBase', 'Enemy Base', 'You have entered the enemy base', 'intel', 5)); 							//locale 0
		locales.push(new locale('offworld', 'Offworld', 'You are offworld', 'none', 5));											//locale 1
		locales.push(new locale('village', 'Village', 'You are in a village', 'none', 5));											//locale 2
		locales.push(new locale('office', 'Office', 'You are in an office', 'stapler', 5));											//locale 3
		locales.push(new locale('gateroom', 'Gateroom', 'You are in the gateroom', 'none', 5));										//locale 4
		locales.push(new locale('armory', 'Armory', 'You are in the armory', 'gun', 5));											//locale 5
		locales.push(new locale('sleepingquaters', 'Sleeping Quarters', 'You are in the sleeping quarters', 'none', 5));			//locale 6
		locales.push(new locale('laboratory', 'Laboratory', 'You are in the laboratory', 'none', 5));								//locale 7
		locales.push(new locale('cafe', 'Cafe', 'You are in the cafe', 'none', 5));													//locale 8
		var item = function(itemID, itemName, itemDescription, itemCount){
			this.itemID = itemID;
			this.itemName = itemName;
			this.itemDescription = itemDescription;
			this.itemCount = itemCount;
		}
		var items = [];
		items.push(new item('intel', 'Enemy Intel', 'You have picked up a key piece of enemy inteligence, it can be used to help win the war', 1));	//locale 0
		items.push(new item('na', 'na', 'na', 0));																									//locale 1
		items.push(new item('na', 'na', 'na', 0));																									//locale 2
		items.push(new item('stapler', 'Stapler', 'You have picked up a stapler, it can staple paper together', 1));								//locale 3
		items.push(new item('na', 'na', 'na', 0));																									//locale 4
		items.push(new item('gun', 'Assault Rifle', 'You have picked up an Assault Rifle, it can be used to kill you enemies', 1));					//locale 5
		items.push(new item('na', 'na', 'na', 0));																									//locale 6
		items.push(new item('na', 'na', 'na', 0));																									//locale 7
		items.push(new item('na', 'na', 'na', 0));																									//locale 8
		var currentLocale=map[x][y];
		var inventory = [];
		var pointsArray = [];
		
		function updateDisplay() {
            var msg = "";
			msg = locales[currentLocale].description;
			score();
			var taPtr = document.getElementById("taDisplay");
            var history = taPtr.value;
            taPtr.value = msg + "\n" + history;
			
		}
         
        function go(dir, currentLocation) {
            var before = currentLocale;
			if (dir === 'north'){
				if(map[x-1][y]!=-1)
				currentLocale=map[x-=1][y];
			}
			else if (dir === 'south'){
				if(map[x+1][y]!=-1)
				currentLocale=map[x+=1][y];
			}
			else if (dir === 'east'){
				if(map[x][y+1]!=-1)
				currentLocale=map[x][y+=1];
			}
			else if (dir === 'west'){
				if(map[x][y-1]!=-1)
				currentLocale=map[x][y-=1];
			}
			else if (dir === 'quit'){
				currentLocale=100;
			}
			buttonDisable();
			if (currentLocale != before) {
               updateDisplay();
            }
         }
		function buttonDisable(){
			if(map[x-1][y]!=-1){
				document.getElementById('northButton').disabled = false;
			}
			if(map[x+1][y]!=-1){
				document.getElementById('southButton').disabled = false;
			}
			if(map[x][y-1]!=-1){
				document.getElementById('westButton').disabled = false;
			}
			if(map[x][y+1]!=-1){
				document.getElementById('eastButton').disabled = false;
			}
			if(map[x-1][y]===-1){
				document.getElementById('northButton').disabled = true;
			}
			if(map[x+1][y]===-1){
				document.getElementById('southButton').disabled = true;
			}
			if(map[x][y-1]===-1){
				document.getElementById('westButton').disabled = true;
			}
			if(map[x][y+1]===-1){
				document.getElementById('eastButton').disabled = true;
			}
		}
		function textBasedMovement(){
			var textInput=(document.getElementById('textInputBox').value);
			var taPtr = document.getElementById('taDisplay');
			var history = taPtr.value;
			if(textInput==='n' || textInput==='N'){
				go('north', currentLocale);
			}
			else if(textInput==='s' || textInput==='S'){
				go('south', currentLocale);
			}
			else if(textInput==='e' || textInput==='E'){
				go('east', currentLocale);
			}
			else if(textInput==='w' || textInput==='W'){
				go('west', currentLocale);
			}
			else if(textInput==='q' || textInput==='Q'){
				go('quit', currentLocale);
			}
			else if(textInput==='d' || textInput==='D'){
				msg = 'you start dancing';
				taPtr.value = msg + '\n' + history;
			}
			else if(textInput==='h' || textInput==='H'){
				msg = ' n: Go North \n s: Go South \n e: Go East \n w: Go West \n d: Dance \n h: Help \n i: Inventory \n p: Pickup';
				taPtr.value = msg + '\n' + history;
			}
			else if(textInput==='i' || textInput==='I'){
				msg = 'The items currently in your inventory are '+ inventory.toString() + '.'; 
				taPtr.value = msg + '\n' + history;
			}
			else if(textInput==='p' || textInput==='P'){
				pickup(currentLocale);
			}
			
			else{
			msg = 'That key does not correspond to an action. To see all possible actions type h';
			taPtr.value = msg + '\n' + history;
			}
			 
		}
		document.onkeydown = function() {
		switch (window.event.keyCode) {
			case 13:
				textBasedMovement();
				break;
			case 37:
				go('west', currentLocale);
				break;
			case 38:
				go('north', currentLocale);
				break;
			case 39:
				go('east', currentLocale);
				break;
			case 40:
				go('south', currentLocale);
				break;
			}	
		};
		
		function score(){
			var pointPtr = document.getElementById('pointDisplay');
			points += locales[currentLocale].points;
			locales[currentLocale].points=0;
			msg=points;
			pointPtr.value = msg;
		}
		function pickup(){
			var taPtr = document.getElementById('taDisplay');
			var history = taPtr.value;
			if(locales[currentLocale].item!="none"){
				inventory.push(locales[currentLocale].item);
				msg = items[currentLocale].itemDescription;
				locales[currentLocale].item = 'none';
				items[currentLocale].itemCount = 0;
			}
			else{
				msg = 'There is nothing here to pickup.';
			}
			taPtr.value = msg + '\n' + history;
		}
		
			
		
      </script>
   </head>
   
   
   <body onload="updateDisplay();">
   
      <h2>Simple Game</h2>
	  
      <textarea id="taDisplay" style="width:400px; height:200px;"></textarea>
	  <textarea id="pointDisplay" style="width:100px; height:50px;"></textarea>
      <br>
	  <!--button based movement-->
      <input type="button"
             value = "North"
			 id="northButton"
             onclick="go('north', currentLocale);">
      <input type="button"
             value = "South"
			 id="southButton"
             onclick="go('south', currentLocale);">
      <input type="button"
             value = "East"
			 id="eastButton"
             onclick="go('east', currentLocale);">
      <input type="button"
             value = "West"
			 id="westButton"
             onclick="go('west', currentLocale);">
	  <br>
	  
	<!--text based movement-->  
	<input type="text" id="textInputBox" size="1" value="" >
	<input type="button" value="Go"
	onclick="textBasedMovement();">

   </body>
</html>